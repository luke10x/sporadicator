version: '3.4'

services:

  aws:
    image: amazon/aws-cli
    volumes:
      - ./extra/aws:/root/.aws

  h2sproxy:
    build:
      context: .
      dockerfile: Dockerfile.dev
    volumes:
      - .:/h2sproxy
    command: "mvn spring-boot:run"
    ports:
      - 8080:8080
      - 5005:5005

  sqs:
    image: softwaremill/elasticmq-native
    volumes:
      - ./extra/sqs/custom.conf:/opt/elasticmq.conf
    ports:
      - 9324:9324
      - 9325:9325

  bus:
    image: node
    working_dir: /bus
    volumes:
      - ./extra/bus/:/bus
    entrypoint: "/bin/bash -c"
    command:
      - |
        npm start || (\
          echo "â›” \`npm start\` failed, but the container is running..." && \
          tail -f /dev/null \
        )



